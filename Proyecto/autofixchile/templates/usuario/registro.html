<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Registro</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <!-- Barra de navegacion principal -->
    <div class="container-fluid" style="background-color: rgb(144, 144, 179)">
      <ul class="nav">
        <a class="link" href="../index.html">
          <img src="../img/logo.png" height="40" alt="logo" style="margin: 5px"
        /></a>
        <a
          class="link"
          href="../index.html"
          style="color: black; text-decoration: none"
        >
          <h1 class="title">
            <strong> AutoFixChile </strong>
          </h1></a
        >
      </ul>
    </div>
    <!-- Container formulario -->
    <div
      class="container mt-5 mb-5"
      style="
        background-color: white;
        border-radius: 5px;
        height: 50rem;
        max-width: 600px;
      "
    >
      <h2 style="text-align: center">Registro de Usuario</h2>
      <form id="Registro_Usuario" novalidate>
        <div class="mb-3">
          <label for="nombre" class="form-label">Nombre</label>
          <input
            type="text"
            class="form-control"
            id="nombre"
            name="nombre"
            required
          />
          <div class="invalid-feedback">Por favor ingrese su nombre.</div>
        </div>
        <div class="mb-3">
          <label for="apellidos" class="form-label">Apellidos</label>
          <input
            type="text"
            class="form-control"
            id="apellidos"
            name="apellidos"
            required
          />
          <div class="invalid-feedback">Por favor ingrese sus apellidos.</div>
        </div>
        <div class="mb-3">
          <label for="run" class="form-label">RUN</label>
          <input
            type="text"
            class="form-control"
            id="run"
            name="run"
            placeholder="12345678-9"
            required
          />
          <div class="invalid-feedback">Formato RUN inválido (12345678-9)</div>
        </div>
        <div class="mb-3">
          <label for="fechaNacimiento" class="form-label"
            >Fecha de Nacimiento</label
          >
          <input
            type="date"
            class="form-control"
            id="fechaNacimiento"
            name="fechaNacimiento"
            required
          />
          <div class="invalid-feedback">
            Por favor ingrese su fecha de nacimiento.
          </div>
        </div>
        <div class="mb-3">
          <label for="telefono" class="form-label">Teléfono</label>
          <input
            type="tel"
            class="form-control"
            id="telefono"
            name="telefono"
            required
          />
          <div class="invalid-feedback">Por favor ingrese su teléfono.</div>
        </div>
        <div class="mb-3">
          <label for="direccion" class="form-label">Dirección</label>
          <input
            type="text"
            class="form-control"
            id="direccion"
            name="direccion"
            required
          />
          <div class="invalid-feedback">Por favor ingrese su dirección.</div>
        </div>
        <div class="mb-3">
          <label for="contraseña2" class="form-label">Contraseña</label>
          <input
            type="password"
            class="form-control"
            id="contraseña"
            name="contraseña"
            required
          />
          <div class="invalid-feedback">
            La contraseña debe tener al menos 8 caracteres, una mayúscula, un
            número y un caracter especial.
          </div>
        </div>
        <div class="mb-3">
          <label for="contraseña2" class="form-label">Repetir Contraseña</label>
          <input
            type="password"
            class="form-control"
            id="contraseña2"
            name="contraseña2"
            required
          />
          <div class="invalid-feedback">Las contraseñas no coinciden.</div>
        </div>
        <button type="submit" class="btn btn-primary">Registrarse</button>
      </form>
    </div>
    <script src="../jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#registroForm").on("submit", function (e) {
          e.preventDefault();

          // Limpiar estados previos
          $("input").removeClass("is-invalid");

          let valido = true;

          // Validar nombre y apellidos
          if (!$("#nombre").val().trim()) {
            $("#nombre").addClass("is-invalid");
            valido = false;
          }
          if (!$("#apellidos").val().trim()) {
            $("#apellidos").addClass("is-invalid");
            valido = false;
          }

          // Validar RUN
          const runVal = $("#run").val().trim();
          const runRegex = /^\d{7,8}-[0-9kK]$/;
          if (!runRegex.test(runVal)) {
            $("#run").addClass("is-invalid");
            valido = false;
          }

          // Validar fecha de nacimiento
          const fechaVal = $("#fechaNacimiento").val();
          if (!fechaVal) {
            $("#fechaNacimiento").addClass("is-invalid");
            valido = false;
          }

          // Validar teléfono
          if (!$("#telefono").val().trim()) {
            $("#telefono").addClass("is-invalid");
            valido = false;
          }

          // Validar dirección
          if (!$("#direccion").val().trim()) {
            $("#direccion").addClass("is-invalid");
            valido = false;
          }

          // Validar contraseña
          const contraseña = $("#contraseña").val();
          const passwordRegex =
            /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+={}[\$|\\:;"'<>,.?/~`]).{8,}$/;
          if (!passwordRegex.test(contraseña)) {
            $("#contraseña").addClass("is-invalid");
            valido = false;
          }

          const contraseña2 = $("#contraseña2").val();
          if (contraseña !== contraseña2 || !contraseña2) {
            $("#contraseña2").addClass("is-invalid");
            valido = false;
          }

          if (valido) {
            alert("Usuario registrado con exito");
            this.submit();
            window.location.href = "../index.html";
          }
        });
      });
    </script>
  </body>
</html>
